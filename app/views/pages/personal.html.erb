<div>
  <h1><%= t('.page_title') %></h1>
  <p class="lead">
    <%= t('.page_lead') %>
  </p>
</div>

<p>
  <div class="progress">
    <div class="progress-bar progress-bar-striped bg-info wiz_progress"
         role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
  </div>
</p>

<%= form_with url: create_personal_path, local: true, class: 'wiz_form' do |form| %>

  <div class="wiz_tab">
    <div class="card text-center">
      <div class="card-body">
        <h2 class="card-title">Quelle est la raison de votre demande de prêt?</h2>
        <p>
          <%= form.select :loan_purpose,
                options_for_select([
                  ['Voyage ou Vacances','1'],
                  ['Consolidation de dettes','2'],
                  ['Refinancement de carte de crédit','3'],
                  ['Dépenses médicales','4'],
                  ['Marriage','5'],
                  ['Déménagement','6'],
                  ['Autre','7']
                ]),
                { include_blank: 'Choissez une option...' },
                { class: 'form-control select2', data: { "minimum-results-for-search" => "Infinity" } } %>
        </p>
      </div>
    </div>
  </div>

  <div class="wiz_tab">
    <div class="card text-center">
      <div class="card-body">
        <h2 class="card-title">Combien aimeriez-vous emprunter?</h2>
        <p>
          <h3 id="amount_value">1000</h3>
          <div id="amount_slider" class="noUi-target noUi-horizontal"></div>
          <%= form.hidden_field :loan_amount, value: 1000 %>
        </p>
      </div>
    </div>
  </div>

  <div class="wiz_buttons">
    <button type="button" id="wiz_prevBtn" onclick="wiz_previous();" class="btn btn-light"><%= t('helpers.links.previous') %></button>
    <button type="button" id="wiz_nextBtn" onclick="wiz_next();" class="btn btn-primary"><%= t('helpers.links.next') %></button>
    <%= form.submit t('helpers.submit.send'), id: 'wiz_submitBtn', class: 'btn btn-success', 'data-disable-with': t('helpers.submit.sending') %>
  </div>

<% end %>

<% content_for :head do %>
  <script>
    $(document).on('turbolinks:load', function () {

      wiz_currentTab = 0; // Current tab is set to be the first tab (0)
      wiz_showTab(wiz_currentTab); // Display the current tab

      function filter500( value, type ){
        return value % 1000 ? 2 : 1;
      }
      var amount_slider = document.getElementById('amount_slider');
      noUiSlider.create(amount_slider, {
        start: 1000,
        step: 500,
        connect: [true, false],
        range: { 'min': 1000, 'max': 25000 },
        pips: {
          mode: 'values',
          values: [1000, 5000, 10000, 15000, 20000, 25000],
          density: 2,
          stepped: true
        }
      });
      amount_slider.noUiSlider.on('update', function (values, handle) {
        const amount = values[handle];
        $('#amount_value').html(accounting.formatMoney(amount, accounting_options_locale[current_locale]));
        $('#amount').val(amount);
      });

    });
  </script>
<% end %>
